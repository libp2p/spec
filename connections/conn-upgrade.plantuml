@startuml

entity Initiator
entity Receiver

== Initial protocol handshake ==

Initiator -> Receiver: /multistream/1.0.0
Receiver -> Initiator: /multistream/1.0.0

== Negotiate security protocol ==

Initiator -> Receiver: /tls/1.0.0
note left: Initiator proposes TLS for security

Receiver -> Initiator: na
note right: Receiver does not support TLS yet

Initiator -> Receiver: /secio/1.0.0
note left: Initiator falls back to SECIO

Receiver -> Initiator: /secio/1.0.0
note right: Receiver supports SECIO, echoes back protocol id

... SECIO handshake ...

== Negotiate stream multiplexer ==

Initiator -> Receiver: /mplex/1.0.0
note left: Initiator proposes mplex for stream multiplexing

Receiver -> Initiator: /mplex/1.0.0
note right: Receiver supports mplex, echoes back protocol id

@enduml
